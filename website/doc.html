<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/x-icon" href="/website/images/logo.png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Allied Work</title>
  <script>
    $(function () {
      $("#includedContent").load("header.html");
      $("#Content").load("footer.html");
    });
  </script>
  <style>
    /* Global Styles */
    body {
      margin: 0;
      font-family: sans-serif; /* Fallback for general text */
      background-color: #f3f4f6; /* bg-gray-100 */
      height: 100vh; /* h-screen */
      display: flex; /* flex */
      flex-direction: column; /* flex-col */
      overflow: hidden; /* Prevent body scrolling, let children manage */
    }

    /* Anchor Tag Styling */
    a {
      font-size: 18px;
      font-family: sans-serif;
      text-decoration: none; /* Remove underline by default */
      color: inherit; /* Inherit color from parent for sidebar links */
    }

    /* Custom Scrollbar Styling for better aesthetics */
    body::-webkit-scrollbar {
      width: 12px;
    }

    body::-webkit-scrollbar-track {
      background: #e0e0e0;
      border-radius: 10px;
    }

    body::-webkit-scrollbar-thumb {
      background-color: #38a169; /* Green-700 */
      border-radius: 10px;
      border: 3px solid #e0e0e0;
    }

    /* Style for the main content scrollbar */
    #mainContent::-webkit-scrollbar {
      width: 12px;
    }

    #mainContent::-webkit-scrollbar-track {
      background: #f3f4f6; /* Gray-100 */
      border-radius: 10px;
    }

    #mainContent::-webkit-scrollbar-thumb {
      background-color: #1f4e2e; /* A darker green for the main content */
      border-radius: 10px;
      border: 3px solid #f3f4f6;
    }

    /* Main Container for Sidebar and Content */
    .content-wrapper {
      display: flex; /* flex */
      flex-grow: 1; /* flex-grow */
      overflow: hidden; /* overflow-hidden */
    }

    /* Sidebar Styles */
    #sidebar {
      width: 20%; /* w-1/5 */
      background-color: #1f4e2e; /* bg-green-800 (initial color) */
      color: #ffffff; /* text-white */
      padding: 1.5rem 1rem; /* py-6 px-4 */
      overflow-y: auto; /* overflow-y-auto */
      transition: background-color 0.5s ease-in-out; /* transition-colors duration-500 */
      flex-shrink: 0; /* flex-shrink-0 */
      border-top-right-radius: 0.75rem; /* rounded-tr-xl */
      border-bottom-right-radius: 0.75rem; /* rounded-br-xl */
      box-shadow: 6px 0 10px rgba(0, 0, 0, 0.1); /* shadow-lg */
    }

    #sidebar h3 {
      font-size: 1.25rem; /* text-xl */
      font-weight: bold; /* font-bold */
      margin-bottom: 1.5rem; /* mb-6 */
      text-align: center; /* text-center */
    }

    #sidebar ul {
      list-style: none; /* Remove bullet points */
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 1rem; /* space-y-4 */
    }

    #sidebar ul li a {
      display: block; /* block */
      padding: 0.5rem 1rem; /* p-2 */
      border-radius: 0.375rem; /* rounded-md */
      transition: background-color 0.2s ease-in-out; /* transition-colors duration-200 */
    }

    #sidebar ul li a:hover {
      background-color: #065f46; /* hover:bg-green-700 */
      text-decoration: underline;
    }

    /* Main Content Styles */
    #mainContent {
      width: 80%; /* w-4/5 */
      background-color: #ffffff; /* bg-white */
      padding: 2.5rem; /* p-10 */
      overflow-y: auto; /* overflow-y-auto */
      scroll-behavior: smooth; /* scroll-smooth */
      display: flex;
      flex-direction: column;
      gap: 4rem; /* space-y-16 */
      flex-grow: 1; /* flex-grow */
      border-top-left-radius: 0.75rem; /* rounded-tl-xl */
      border-bottom-left-radius: 0.75rem; /* rounded-bl-xl */
      box-shadow: -6px 0 10px rgba(0, 0, 0, 0.05); /* shadow-inner */
    }

    /* Section Styles */
    .content-section {
      margin-bottom: 3rem; /* mb-12 */
      padding: 1.5rem; /* p-6 */
      background-color: #f9fafb; /* bg-gray-50 */
      border-radius: 0.5rem; /* rounded-lg */
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08); /* shadow-md */
    }

    .content-section h2 {
      font-size: 2.25rem; /* text-4xl */
      font-weight: bold; /* font-bold */
      margin-bottom: 1rem; /* mb-4 */
      color: #064e3b; /* text-green-900 */
    }

    .content-section p {
      font-size: 1.125rem; /* text-lg */
      font-weight: 600; /* font-semibold */
      color: #374151; /* text-gray-700 */
      line-height: 1.625; /* leading-relaxed */
    }

    .content-section p + p {
      margin-top: 1rem; /* mt-4 for subsequent paragraphs */
    }

    /* New Paragraph Form Styles */
    .new-paragraph-form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      padding: 1.5rem;
      border: 2px solid #ddd;
      border-radius: 8px;
      margin-top: 2rem;
    }

    .new-paragraph-form textarea {
      width: 100%;
      height: 100px;
      padding: 10px;
      border-radius: 4px;
      border: 1px solid #ccc;
      resize: vertical;
    }

    .new-paragraph-form button {
      padding: 10px 20px;
      background-color: #1f4e2e;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.2s;
    }

    .new-paragraph-form button:hover {
      background-color: #065f46;
    }
  </style>
</head>
<body class="bg-gray-100 h-screen flex flex-col">
  <div id="includedContent"></div>
  
  <div class="content-wrapper">
    <nav id="sidebar">
      <h3>Sections</h3>
      <ul id="sidebar-links"></ul>
    </nav>
    
    <main id="mainContent">
      <form id="new-paragraph-form" class="new-paragraph-form">
        <label for="newParagraphText">Add New Paragraph:</label>
        <textarea id="newParagraphText" placeholder="Write your new paragraph here..." required></textarea>
        <button type="submit">Add Paragraph</button>
      </form>
    </main>
  </div>
  
  <div id="Content"></div>
  
  <script type="module">
    import { pageContent } from './doc.js';

    const mainContent = document.getElementById('mainContent');
    const sidebar = document.getElementById('sidebar');
    const sidebarLinks = document.getElementById('sidebar-links');
    const newParagraphForm = document.getElementById('new-paragraph-form');
    
    const sections = Object.keys(pageContent);
    
    // Function to render the content dynamically
    function renderContent() {
      // Clear existing content and sidebar links
      document.querySelectorAll('.content-section').forEach(el => el.remove());
      sidebarLinks.innerHTML = '';
      
      // Loop through data and create sections and sidebar links
      for (const [id, section] of Object.entries(pageContent)) {
        // Create Section Div
        const sectionDiv = document.createElement('div');
        sectionDiv.id = id;
        sectionDiv.className = 'content-section';
        
        // Create Heading
        const heading = document.createElement('h2');
        heading.textContent = section.title;
        if (section.style) {
          heading.style = section.style;
        }
        sectionDiv.appendChild(heading);
        
        // Create Paragraphs
        section.paragraphs.forEach(text => {
          const p = document.createElement('p');
          p.textContent = text;
          sectionDiv.appendChild(p);
        });
        
        // Add to the main content area after the form
        mainContent.appendChild(sectionDiv);
        
        // Create Sidebar Link
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = `#${id}`;
        a.textContent = section.title;
        li.appendChild(a);
        sidebarLinks.appendChild(li);
      }
      
      // Re-observe elements for IntersectionObserver
      reObserveSections();
    }
    
    // Add new paragraph functionality
    newParagraphForm.addEventListener('submit', (event) => {
      event.preventDefault();
      const newParagraphText = document.getElementById('newParagraphText').value;
      
      // Create a new unique ID for the section
      const newSectionId = `new-paragraph-${Object.keys(pageContent).length + 1}`;
      
      // Add the new data to the pageContent object
      pageContent[newSectionId] = {
        title: `New Paragraph ${Object.keys(pageContent).length + 1}`,
        paragraphs: [newParagraphText],
      };
      
      // Re-render the content
      renderContent();
      
      // Scroll to the new section
      document.getElementById(newSectionId).scrollIntoView({ behavior: 'smooth' });
      
      // Clear the textarea
      document.getElementById('newParagraphText').value = '';
    });
    
    // Intersection Observer to change sidebar color on scroll
    let observer = null;
    function reObserveSections() {
      if (observer) {
        observer.disconnect();
      }
      
      observer = new IntersectionObserver(
        (entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting && entry.intersectionRatio >= 0.6) {
              const id = entry.target.id;
              switch (id) {
                case 'what-is-it':
                  sidebar.style.backgroundColor = '#10B981'; // Green-500
                  break;
                case 'autocorrection':
                  sidebar.style.backgroundColor = 'purple'; // purple
                  break;
                case 'related':
                  sidebar.style.backgroundColor = '#047857'; // Green-700
                  break;
                case 'AACWork':
                  sidebar.style.backgroundColor = '#065f46'; // Green-800
                  break;
                case 'benefits':
                  sidebar.style.backgroundColor = '#0B4D3A'; // Darker green
                  break;
                default:
                  sidebar.style.backgroundColor = '#1f4e2e'; // Default green
              }
            }
          });
        },
        {
          root: mainContent,
          threshold: 0.6
        }
      );
      
      document.querySelectorAll('.content-section').forEach(sectionElement => {
        observer.observe(sectionElement);
      });
      
      // Ensure initial sidebar color based on first section
      if (document.getElementById('what-is-it') && document.getElementById('what-is-it').getBoundingClientRect().top < mainContent.clientHeight * 0.6) {
        sidebar.style.backgroundColor = '#10B981';
      }
    }
    
    // Initial render when the page loads
    renderContent();
  </script>
</body>
</html>