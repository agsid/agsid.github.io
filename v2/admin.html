<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Cars</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body {
    background: url('https://img.freepik.com/free-photo/view-starry-night-sky-with-nature-mountains-landscape_23-2151614765.jpg?semt=ais_hybrid&w=740&q=80      ') no-repeat center center fixed;
    background-size: cover;
    font-family: 'Arial', sans-serif;
  }
  .glass-card {
    backdrop-filter: blur(15px);
    background: rgba(255,255,255,0.1);
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
  }
</style>
</head>
<body class="text-white">

<!-- Top Navbar -->
<header class="flex justify-between items-center p-4 bg-gray-800/70 backdrop-blur-md shadow-md">
  <h1 class="text-xl font-semibold">Admin Page - Cars</h1>
  <div class="relative">
    <button id="profile-btn" class="flex items-center gap-2 rounded-full hover:bg-gray-700 p-1">
      <img id="profile-pic" class="w-10 h-10 rounded-full" src="" alt="Profile">
      <span id="profile-name" class="hidden md:inline"></span>
    </button>
    <div id="profile-menu" class="hidden absolute right-0 mt-2 w-40 bg-gray-900/90 rounded shadow-lg">
      <button id="logout-btn" class="w-full text-left px-4 py-2 hover:bg-gray-700 rounded">Logout</button>
    </div>
  </div>
</header>

<main class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">

  <!-- Cars Section -->
  <div class="glass-card">
    <h2 class="text-xl font-semibold mb-4">Cars</h2>
    <div id="cars-container" class="space-y-4"></div>
    <button id="add-car" class="mt-4 bg-blue-600 hover:bg-blue-500 px-4 py-2 rounded w-full">Add New Car</button>
  </div>

</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, onValue, update, set } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDLhVsvxJlOvqKqEjXQUActO0Sf0S0hgLw",
  authDomain: "football-9b7e3.firebaseapp.com",
  databaseURL: "https://football-9b7e3-default-rtdb.firebaseio.com",
  projectId: "football-9b7e3",
  storageBucket: "football-9b7e3.firebasestorage.app",
  messagingSenderId: "821823406502",
  appId: "1:821823406502:web:5d9a5aacadc0be4da8cf67",
  measurementId: "G-HH3C611R83"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

const carsContainer = document.getElementById('cars-container');
const addCarBtn = document.getElementById('add-car');
const profileBtn = document.getElementById('profile-btn');
const profileMenu = document.getElementById('profile-menu');
const profilePic = document.getElementById('profile-pic');
const profileName = document.getElementById('profile-name');
const logoutBtn = document.getElementById('logout-btn');

let currentUser = null;

// Toggle profile menu
profileBtn.addEventListener('click', () => profileMenu.classList.toggle('hidden'));

// Logout
logoutBtn.addEventListener('click', () => signOut(auth));

// Auth check
onAuthStateChanged(auth, user => {
  if (!user) {
    window.location.href = 'login.html';
  } else {
    currentUser = user;
    profilePic.src = user.photoURL || 'https://via.placeholder.com/150';
    profileName.textContent = user.displayName || user.email;
    profileName.classList.remove('hidden');
    loadCars();
  }
});

// Load cars from Firebase
function loadCars() {
  const carsRef = ref(db, 'cars');
  onValue(carsRef, snapshot => {
    const cars = snapshot.val() || {};
    carsContainer.innerHTML = '';
    Object.keys(cars).forEach(key => {
      const c = cars[key];
      const card = document.createElement('div');
      card.className = 'bg-gray-800 p-4 rounded shadow space-y-2';
      card.innerHTML = `
        <input type="text" value="${c.name}" placeholder="Car Name" class="w-full p-2 rounded text-black"/>
        <input type="text" value="${c.image}" placeholder="Image URL" class="w-full p-2 rounded text-black"/>
        <button class="bg-green-600 hover:bg-green-500 px-3 py-1 rounded w-full">Save</button>
      `;
      card.querySelector('button').addEventListener('click', () => {
        const inputs = card.querySelectorAll('input');
        update(ref(db, 'cars/' + key), {
          name: inputs[0].value,
          image: inputs[1].value
        });
      });
      carsContainer.appendChild(card);
    });
  });
}

// Add new car
addCarBtn.addEventListener('click', () => {
  set(ref(db, 'cars/car' + Date.now()), { name:'New Car', image:'' });
});
</script>

</body>
</html>
