<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Cars</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body {
  background: url('https://static.vecteezy.com/system/resources/thumbnails/011/457/898/small_2x/flower-and-mountain-landscape-background-free-vector.jpg') no-repeat center center fixed;
  background-size: cover;
  font-family: 'Arial', sans-serif;
}
.glass-card {
  backdrop-filter: blur(15px);
  background: rgba(255,255,255,0.1);
  border-radius: 1rem;
  padding: 1.5rem;
  box-shadow: 0 10px 25px rgba(0,0,0,0.3);
}
.dropdown {
  position: relative;
  display: inline-block;
}
.dropdown-content {
  display: none;
  position: absolute;
  right: 0;
  background-color: rgba(30,30,30,0.95);
  min-width: 160px;
  border-radius: 0.5rem;
  padding: 0.5rem 0;
  box-shadow: 0 8px 16px rgba(0,0,0,0.3);
  z-index: 1;
}
.dropdown-content button {
  width: 100%;
  text-align: left;
  padding: 0.5rem 1rem;
  background: none;
  border: none;
  color: white;
  cursor: pointer;
}
.dropdown-content button:hover {
  background-color: rgba(255,255,255,0.1);
}
.dropdown:hover .dropdown-content {
  display: block;
}
</style>
</head>
<body class="text-white min-h-screen flex flex-col">

<header class="bg-gray-800/70 backdrop-blur-md shadow-md p-4 flex justify-between items-center">
  <div class="text-xl font-semibold">Admin Page - Cars</div>
  <div class="dropdown">
    <span id="user-email" class="cursor-pointer px-4 py-2 rounded bg-gray-700 hover:bg-gray-600"></span>
    <div class="dropdown-content">
      <button id="logout-btn">Logout</button>
    </div>
  </div>
</header>

<main class="p-6 flex-1">
  <section>
    <h2 class="text-xl font-semibold mb-4">Cars</h2>
    <div id="cars-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
    <button id="add-car" class="mt-4 bg-green-600 hover:bg-green-500 px-4 py-2 rounded">Add New Car</button>
  </section>
</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, onValue, update, set } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";
import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyDLhVsvxJlOvqKqEjXQUActO0Sf0S0hgLw",
  authDomain: "football-9b7e3.firebaseapp.com",
  databaseURL: "https://football-9b7e3-default-rtdb.firebaseio.com",
  projectId: "football-9b7e3",
  storageBucket: "football-9b7e3.firebasestorage.app",
  messagingSenderId: "821823406502",
  appId: "1:821823406502:web:5d9a5aacadc0be4da8cf67",
  measurementId: "G-HH3C611R83"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

const carsContainer = document.getElementById('cars-container');
const logoutBtn = document.getElementById('logout-btn');
const userEmailDisplay = document.getElementById('user-email');

// Redirect if not signed in
onAuthStateChanged(auth, user => {
  if (!user) {
    window.location.href = 'login.html';
  } else {
    userEmailDisplay.textContent = user.email;
    loadCars();
  }
});

// Logout
logoutBtn.addEventListener('click', async () => {
  await signOut(auth);
  window.location.href = 'login.html';
});

// Load cars
function loadCars() {
  const carsRef = ref(db, 'cars');
  onValue(carsRef, snapshot => {
    const cars = snapshot.val() || {};
    carsContainer.innerHTML = '';
    Object.keys(cars).forEach(key => {
      const car = cars[key];
      const card = document.createElement('div');
      card.className = 'glass-card flex flex-col items-center text-center';
      card.innerHTML = `
        <img src="${car.image || 'https://via.placeholder.com/150'}" alt="${car.name}" class="w-full h-48 object-cover rounded mb-2"/>
        <input type="text" value="${car.name}" placeholder="Car Name" class="w-full mb-2 p-1 rounded text-black"/>
        <input type="text" value="${car.image}" placeholder="Image URL" class="w-full mb-2 p-1 rounded text-black"/>
        <button class="mt-2 bg-purple-600 hover:bg-purple-500 px-2 py-1 rounded w-full">Save</button>
      `;
      // Save button
      card.querySelector('button').addEventListener('click', () => {
        const inputs = card.querySelectorAll('input');
        update(ref(db, 'cars/' + key), {
          name: inputs[0].value,
          image: inputs[1].value
        });
      });
      carsContainer.appendChild(card);
    });
  });
}

// Add new car
document.getElementById('add-car').addEventListener('click', () => {
  set(ref(db, 'cars/car' + Date.now()), { name:'New Car', image:'' });
});
</script>

</body>
</html>
